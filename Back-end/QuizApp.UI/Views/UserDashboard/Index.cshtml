@model List<QuizApp.UI.Models.QuizDashboardViewModel>
@{
    Layout = "_Layout";
    ViewData["Title"] = "User Dashboard";
}

<style>
    body {
        background: linear-gradient(135deg, #0d6efd 20%, #092b72 100%);
        color: #fff;
        font-family: 'Segoe UI', sans-serif;
        min-height: 100vh;
    }

    .dashboard-header {
        text-align: center;
        margin-top: 30px;
        margin-bottom: 40px;
    }

        .dashboard-header h2 {
            font-weight: 700;
            color: #fff;
        }

    .quiz-card {
        background-color: #ffffff;
        border: none;
        border-radius: 15px;
        box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        color: #333;
        transition: all 0.3s ease-in-out;
    }

        .quiz-card:hover {
            transform: translateY(-6px);
            box-shadow: 0 8px 16px rgba(0,0,0,0.2);
        }

        .quiz-card .card-header {
            background-color: #0d6efd;
            color: white;
            border-top-left-radius: 15px;
            border-top-right-radius: 15px;
            text-align: center;
            font-weight: 600;
            font-size: 1.2rem;
        }

        .quiz-card .progress {
            height: 8px;
            border-radius: 10px;
            margin-top: 8px;
        }

        .quiz-card .card-footer {
            background-color: #f8f9fa;
            border-top: none;
        }

    .attempted {
        color: #198754;
        font-weight: bold;
    }

    .not-attempted {
        color: #dc3545;
        font-weight: bold;
    }
</style>

<div class="container py-5">
    <div class="dashboard-header">
        <h2><i class="bi bi-person-circle me-2"></i>Welcome to Your Dashboard</h2>
        <p class="text-light">View available quizzes, attempt them, and track your performance!</p>
    </div>

    <div class="row g-4">
        @foreach (var quiz in Model)
        {
            var isAttempted = quiz.UserAttempt != null;
            var percentage = quiz.TotalScore > 0 ? Math.Round(((double)quiz.ObtainedScore / quiz.TotalScore) * 100, 1) : 0;
            <div class="col-md-6 col-lg-4">
                <div class="card quiz-card h-100">
                    <div class="card-header">
                        @quiz.Title
                    </div>
                    <div class="card-body">
                        <p class="card-text">@quiz.Description</p>
                        <p><strong>Time Allowed:</strong> @quiz.TimeAllowed mins</p>
                        <p>
                            <strong>Score:</strong>
                            @if (isAttempted)
                            {
                                <span class="attempted">@quiz.ObtainedScore / @quiz.TotalScore</span>
                            }
                            else
                            {
                                <span class="not-attempted">Not Attempted</span>
                            }
                        </p>

                        <div class="progress">
                            <div class="progress-bar bg-info" role="progressbar"
                                 style="width:@percentage%"
                                 aria-valuenow="@percentage"
                                 aria-valuemin="0" aria-valuemax="100"></div>
                        </div>
                    </div>
                    <div class="card-footer text-center">
                        @if (isAttempted)
                        {
                            <a href="@Url.Action("Start", "TakeQuiz", new { quizId = quiz.QuizId })"
                               class="btn btn-outline-primary btn-sm">
                                <i class="bi bi-arrow-repeat"></i> Retake Quiz
                            </a>
                        }
                        else
                        {
                            <a href="@Url.Action("Start", "TakeQuiz", new { quizId = quiz.QuizId })"
                               class="btn btn-primary btn-sm">
                                <i class="bi bi-play-circle"></i> Start Quiz
                            </a>
                        }
                    </div>
                </div>
            </div>
        }
    </div>
</div>
